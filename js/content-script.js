!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=4)}([function(e,t,a){"use strict";a.d(t,"r",function(){return i}),a.d(t,"f",function(){return s}),a.d(t,"m",function(){return c}),a.d(t,"e",function(){return d}),a.d(t,"s",function(){return l}),a.d(t,"o",function(){return p}),a.d(t,"c",function(){return u}),a.d(t,"g",function(){return m}),a.d(t,"i",function(){return v}),a.d(t,"h",function(){return h}),a.d(t,"k",function(){return f}),a.d(t,"b",function(){return g}),a.d(t,"p",function(){return I}),a.d(t,"j",function(){return y}),a.d(t,"l",function(){return b}),a.d(t,"a",function(){return x}),a.d(t,"d",function(){return S}),a.d(t,"n",function(){return w}),a.d(t,"q",function(){return k});var n=a(1),r=function(){var e=localStorage.valueOf(),t="";for(var a in e)if(-1!=a.indexOf("//sycm.taobao.com/portal/common/commDate.json?targetUrl=http://sycm.taobao.com/mc")){t=e[a];break}if(!t)return"";var n=JSON.parse(t).split("|")[1];return JSON.parse(n).value._d}();function i(e,t){var a=e,n=o("yyyy-MM-dd",new Date(a));return"day"==t?n+"|"+n:"recent7"==t?o("yyyy-MM-dd",new Date(a-5184e5))+"|"+n:o("yyyy-MM-dd",new Date(a-25056e5))+"|"+n}function o(e,t){if(!t)return"";var a={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return e}function s(e,t,a){return"undefined"!=e&&""!==e&&"-"!=e&&t&&"-"!=t&&"0"!=t?(e=(e+"").replace(",",""),t=(t+"").replace(",",""),1==a?(Math.round(e/t*100)/100).toFixed(2):2==a?(Math.round(e/t*1e4)/100).toFixed(2)+"%":void 0):"-"}function c(e,t){return 0==e?0:e&&"-"!=e?(e=(e+"").replace(",",""),"inter"==t?Math.round(e):"precent"==t&&-1!==e.indexOf("%")?e.slice(0,-1)/100:e):"-"}function d(e){return-1!==(e=(e+"").replace(",","")).indexOf("%")?e.slice(0,-1)/100:e}function l(e){var t=/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:\/~\+#]*[\w\-\@?^=%&amp;\/~\+#])?/.test(e),a=/^\d+$/.test(e),n="";return t?(e.split("?")[1].split("&").forEach(function(e){var t=e.split("=");"id"==t[0]&&(n=t[1])}),n):!!a&&e}function p(e,t,a){e=(e+"").replace(",",""),t=(t+"").replace(",",""),a=(a+"").replace(",","");var n={num1:0,num2:0};return e&&t&&"-"!=e&&"-"!=t&&"0"!=t?a&&"-"!=a?(n.num1=Math.round(e*t/100),n.num2=n.num1?Math.round(a/n.num1*100).toFixed(2)/100:"-"):(n.num1=Math.round(e*t/100),n.num2="-"):(n.num1="-",n.num2="-"),n}function u(e,t,a){var n={res1:0,res2:0};if(e&&"-"!=e&&t&&"-"!=t){e=(e+"").replace(",",""),t=(t+"").replace(",","").slice(0,-1),a=(a+"").replace(",","");var r=e*t;n.res1=Math.round(r/100),n.res2="-"==a?"-":r?Math.round(a/r*1e4)/100:"-"}else n.res1="-",n.res2="-";return n}function m(e){var t=r.updateNDay,a=r.update1Day,n="moreDay"==e?t:a;return(n?new Date(n).getTime():localStorage.getItem("currentDate")?JSON.parse(localStorage.getItem("currentDate")).data.timestamp:"")||(new Date).getTime()}function v(){var e=localStorage.getItem("shopCateId"),t=JSON.parse(localStorage.getItem("tree_history_op-mc._cate_picker")).split("|")[1],a=t?JSON.parse(t).value:"";return a?a[0].realObj.cateLevel1Id:e}function h(e,t){for(var a=[],n=t||"yyyy-MM-dd",r=1;r<31;r++)a.unshift(o(n,new Date(e-864e5*r)));return a}function f(e,t,a,n){var r=$(".oui-date-picker .ant-btn-primary").text(),o="实 时"==r?"today":"7天"==r?"recent7":"30天"==r?"recent30":"日"==r?"day":"周"==r?"week":"月"==r?"month":"today",s=$(".ebase-FaCommonFilter__root .fa-common-filter-device-select .oui-select-container-value").html(),c=$(".ebase-FaCommonFilter__root .sellerType-select .ant-select-selection-selected-value").attr("title"),d="所有终端"==s?"0":"PC端"==s?"1":"无线端"==s?"2":"",l="全部"==c?"-1":"天猫"==c?"1":"淘宝"==c?"0":"",p=$(".ebase-FaCommonFilter__root .oui-date-picker .oui-date-picker-current-date").text().split(" "),u=p.length,h="";3==u||2==u?h=p[1]+"|"+p[1]:4==u&&(h=n?p[3]+"|"+p[3]:p[1]+"|"+p[3]),t=t||1,a=a||10,"allTrend"==e&&(h=i(m(),"day"));var f=v();return n?e+"cateId="+f+"&dateRange="+h+"&dateType=day&device="+d+"&sellerType="+l:e+"cateId="+f+"&dateRange="+h+"&dateType="+o+"&device="+d+"&page="+t+"&pageSize="+a+"&sellerType="+l}function g(e){if(!e)return $(".load-pop").fadeOut(100),!1;var t=$(".load-pop");t.length&&t.fadeIn(200),$("body").append('<div class="load-pop"><div class="spinner"><div class="spinner-container container1"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div><div class="spinner-container container2"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div><div class="spinner-container container3"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div></div>')}function I(e,t,a){$("#app").append('<div class="small-alert" style="'+t+'">'+e+"</div>"),setTimeout(function(){$("#app .small-alert").fadeOut(300)},500)}function y(){for(var e=$("#itemAnalysisSelect .sycm-common-select-wrapper .alife-dt-card-sycm-common-select"),t={selfItem:{imgurl:"",title:""},rivalItem1:{imgurl:"",title:""},rivalItem2:{imgurl:"",title:""},totalNum:0},a=0;a<3;a++){var n=$(e[a]).find(".sycm-common-select-selected-title"),r=$(e[a]).find(".sycm-common-select-selected-image-wrapper img");if(n.length){var i=n?n.attr("title"):"",o=r?r.attr("src"):"";t.totalNum+=1,0==a?(t.selfItem.imgurl=o,t.selfItem.title=i):1==a?(t.rivalItem1.imgurl=o,t.rivalItem1.title=i):2==a&&(t.rivalItem2.imgurl=o,t.rivalItem2.title=i)}}return t}function b(e,t,a){var n=localStorage.getItem("chaqz_compareSelfList")||function(){var e=JSON.parse(localStorage.getItem("/mc/rivalShop/recommend/item.json"));return x(e?JSON.parse(e.split("|")[1]).value._d:"")}(),r=t.getMonitoredList.data;if(!n||!r.length)return I("获取竞品数据失败，请刷新重试！"),g(),!1;for(var i=JSON.parse(n),o=JSON.parse(r),s={item1:"",item2:"",self:""},c="",d="",l="",p=0;p<i.length;p++)i[p].title==e.selfItem.title&&(l="&selfItemId="+i[p].itemId,s.self=i[p]);for(var u=0;u<o.length;u++)o[u].name==e.rivalItem1.title?(s.item1=o[u],c="&rivalItem1Id="+o[u].itemId):o[u].name==e.rivalItem2.title&&(s.item2=o[u],d="&rivalItem2Id="+o[u].itemId);return"idObj"==a?s:c+d+l}function x(e){var t=CryptoJS.enc.Utf8.parse("sycmsycmsycmsycm"),a=CryptoJS.enc.Utf8.parse("mcysmcysmcysmcys");let n=CryptoJS.enc.Hex.parse(e),r=CryptoJS.enc.Base64.stringify(n);return CryptoJS.AES.decrypt(r,t,{iv:a,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).toString(CryptoJS.enc.Utf8).toString()}function S(){var e=localStorage.getItem("chaqz_shopInfo");return e?JSON.parse(e).data:""}function w(){var e=window.SAVE_MEMBER2;if(!e)return k.init("noShopInfo"),!1;var t=e.member,a=window.SAVE_BIND2,n=S();if(!t.level)return k.init("orderMem"),!1;var r=e.time,i=t.expireAt;if(new Date(i)-1e3*r<=0)return k.init("overdue"),!1;var o=a.data.length,s=a.count,c=!1,d=!1,l=0;return a.data.forEach(function(e){e.runShopId==n.runAsShopId&&(c=!0,d=e.closed),0==e.closed&&l++}),c?0==d||(l<s?(k.init("active2"),!1):t.level<4?(k.init("upLimit"),!1):(k.init("bindLimit"),!1)):o<s?(k.init("binding"),!1):t.level<4?(k.init("upLimit"),!1):(k.init("bindLimit"),!1)}var k={version:'<p class="tips">当前插件已更新，请到官网下载最新版本。</p><div class="cha-btns"><a class="btn" href="'+n.a+'/pluginIntro" target="_blank"><button class="btn">前往下载</button></a></div>',orderMem:'<p class="tips">账户未开通会员，请联系客服或订购会员。</p><div class="cha-btns"><a class="mr_30 btn" href="tencent://message/?uin=3531553166&amp;Site=qq&amp;Menu=yes"><button class="btn">联系客服</button></a><button class="btn buyBtn">订购</button></div>',overdue:'<p class="tips">会员已过期，请重新订购。</p><div class="cha-btns"><button class="btn buyBtn">订购</button></div>',overdue2:'<p class="tips">登录账户未绑定本店铺，<br>如有疑问请联系客服。</p><div class="cha-btns"><a class="mr_30 btn" href="tencent://message/?uin=3531553166&amp;Site=qq&amp;Menu=yes" ><button class="btn">联系客服</button></a><button class="btn hides">取消</button></div>',binding:'<p class="tips">店铺暂未绑定，是否绑定店铺？</p><div class="cha-btns"><button class="hides mr_30 btn">取消</button><button id="goBind" class="btn">绑定</button></div>',nonBind:'<p class="tips">店铺已绑定其余账户，<br>若非本人操作请联系客服。</p><div class="cha-btns"><a class="mr_30 btn" href="tencent://message/?uin=3531553166&amp;Site=qq&amp;Menu=yes" ><button class="btn">联系客服</button></a><button class="btn hides">确定</button></div>',renewal:'<p class="tips"> 会员已过期， 为不影响正常使用，<br>请前往官网续费。</p><div class="cha-btns"><button class="cancel mr_30 btn">暂不处理</button><button class="btn">续费</button></div>',orderSucc:'<p class="tips">若订购成功请刷新。</p><div class="cha-btns"><button id="pageRefresh" class="btn">确定</button></div>',noShopInfo:'<p class="tips">未获取用户信息，请刷新页面重试。</p><div class="cha-btns"><button id="pageRefresh" class="btn">确定</button></div>',upLimit:'<p class="tips">该账户会员已达绑定上限，请升级会员。</p><div class="cha-btns"><button class="btn buyBtn">升级会员</button></div>',bindLimit:'<p class="tips">已达插件绑定上限，请联系客服。</p><div class="cha-btns"><a class="mr_30 btn" href="tencent://message/?uin=3531553166&amp;Site=qq&amp;Menu=yes" ><button class="btn">联系客服</button></div>',weixin:'<p class="head">查权重客服很高兴为您服务</p><img src="https://file.cdn.chaquanzhong.com/wx_contact.jpg" alt="wx"><p class="foot">微信扫一扫 添加客服</p>',goChoose:'<p class="tips">请在竞品分析界面，选择目标竞品。</p><div class="cha-btns"><button class="btn hides">确定</button></div>',onlyOne:'<p class="tips">竞品选择有误，现仅支持单项竞品加权。</p><div class="cha-btns"><button class="btn hides">确定</button></div>',competingGoodsAnalysis:'<p class="head-title">竞品分析</p><div class="analy-goods"><input type="text" class="anayEditor selcet" placeholder="请输入url或者商品id"><p class="good-tips"></p></div><div class="cha-btns"><button class="btn analyBtn">数据解析</button><button class="btn analyBtn">流量解析</button><button class="btn analyBtn">关键词解析</button></div>',competingTopAnalysis:'<p class="head-title">权重解析</p><div class="analy-goods"><input type="text" class="anayEditor selcet" placeholder="请输入url或者商品id"><p class="good-tips"></p></div><div class="cha-btns"><button class="btn hides mr_30 cancel">取消</button><button class="btn analyBtn2">确定</button></div><p class="bot-tips">暂只支持同类目权重解析</p>',selectPlan:function(e){var t="";return e?e.forEach(function(e){t+='<option value="'+e.title+'">'+e.title+"</option>"}):t+='<option value="0">请选择</option>','<p class="head-title">加入加权计划</p><div class="form-list"><div><span>计划名称</span><select class="selcet" placeholder="请选择">'+t+'</select></div><p class="ctPlan">创建新计划</p></div><div class="cha-btns"><button id="vestBtn" class="btn">确定</button></div>'},createPlan:'<p class="head-title" id="giveupPlan">新建计划</p><div class="form-list"><div class="item"><span>计划目的</span><select class="selcet"><option value="新品">新品</option></select></div><div><span>计划名称</span><input type="text" class="editor selcet" placeholder="请输入计划名称"></div></div><div class="cha-btns"><button class="btn planBtn">确定</button></div>',active2:function(){for(var e=SAVE_BIND.data,t=e.length,a="",n=0;n<t;n++)if(e[n]){var r=e[n].closed,i=e[n].mainUname,o=1==r?"未激活":"已激活",s=n+1,c="label"+s;a+='<tr><td><label for="'+c+'" class="'+(1==r?"":"chose")+'"></label><input id='+c+' type="checkbox" '+(1==r?"":"checked disabled")+' data-id="'+e[n].runShopId+'" hidden><span class="num">'+s+"</span></td><td>"+i+"</td><td>"+o+"</td></tr>"}return'<div class="chaqz-info-wrapper pop"><div class="c-cont"><span class="close hides" click="hideInfo">×</span><div class="alert"><div class="table-wrap"><table><thead><tr><td>序号</td><td>店铺名</td><td>状态</td></tr></thead><tbody>'+a+'</tbody></table></div><div class="cha-btns"><button class="btn activeShop">激活</button></div><p class="foot-tips">如有绑定疑问，请<a href="tencent://message/?uin=3531553166&amp;Site=qq&amp;Menu=yes">联系客服</a></p></div></div></div>'},init:function(e,t){if($(".chaqz-info-wrapper.pop").length)return this.changeDom(e,t),!1;var a='<div class="chaqz-info-wrapper pop"><div class="c-cont"><span class="close hides" click="hideInfo">×</span><div class="alert">'+("function"==typeof this[e]?this[e](t):this[e])+"</div></div></div>",r=this;$("#app").append(a),$(".chaqz-info-wrapper.pop").on("click",".buyBtn",function(){window.open(n.a+"/homePage?from=plugin"),r.init("orderSucc")}),$(".chaqz-info-wrapper.pop").on("click","#pageRefresh",function(){window.location.reload()}),$(document).on("click",".chaqz-info-wrapper.pop .ctPlan",function(){r.init("createPlan")}),$(document).on("blur",".chaqz-info-wrapper.pop .editor",function(){if($(this).val().length>8)return $(this).val($(this).val().slice(0,8)),I("最多可输入8个汉字","top:10%;"),!1}),$(document).on("blur",".chaqz-info-wrapper.pop .anayEditor",function(){$(this).siblings(".good-tips").removeClass("alert")}),$(document).on("click",".chaqz-info-wrapper.pop .contactService",function(){r.init("weixin")})},changeDom:function(e,t){var a;a="function"==typeof this[e]?this[e](t):this[e],$(".chaqz-info-wrapper.pop .c-cont .alert").html(a),$(".chaqz-info-wrapper.pop").show()}}},function(e,t,a){"use strict";a.d(t,"c",function(){return n}),a.d(t,"a",function(){return r}),a.d(t,"b",function(){return i});var n={monitShop:{urlReg:"https://sycm.taobao.com/mc(/live/|/)ci/shop/monitor/listShop.json",data:[]},monitFood:{urlReg:"https://sycm.taobao.com/mc(/live/|/)ci/item/monitor/list.json",data:{}},monitCompareFood:{urlReg:"https://sycm.taobao.com/mc/rivalItem/analysis/get(LiveCore|Core)Indexes.json",data:[]},monitResource:{urlReg:"https://sycm.taobao.com/mc/rivalItem/analysis/get(LiveFlow|Flow)Source.json",data:[]},marketShop:{urlReg:"https://sycm.taobao.com/mc(/live/|/)ci/shop/monitor/list.json",data:[]},marketHotShop:{urlReg:"https://sycm.taobao.com/mc/mq/monitor/cate(.*?)/showTopShops.json",data:[]},marketHotFood:{urlReg:"https://sycm.taobao.com/mc/mq/monitor/cate(.*?)/showTopItems.json",data:[]},shopInfo:{urlReg:"https://sycm.taobao.com/custom/menu/getPersonalView.json",data:[]},compareSelfList:{urlReg:"https://sycm.taobao.com/mc/rivalShop/recommend/item.json",data:[]},getMonitoredList:{urlReg:"https://sycm.taobao.com/mc/ci/config/rival/item/getMonitoredList.json",data:[]},getKeywords:{urlReg:"https://sycm.taobao.com/mc/rivalItem/analysis/getKeywords.json",data:[]},hotsale:{urlReg:"https://sycm.taobao.com/mc/mq/mkt/rank/(shop|item|brand)/hotsale.json",data:[]},hotsearch:{urlReg:"https://sycm.taobao.com/mc/mq/mkt/rank(.*?)hotsearch.json",data:[]},hotpurpose:{urlReg:"https://sycm.taobao.com/mc/mq/mkt/rank/item/hotpurpose.json",data:[]},trendShop:{urlReg:"https://sycm.taobao.com/mc/ci/config/rival/(shop|item|brand)/getSingleMonitoredInfo.json",data:[]},allTrend:{urlReg:"https://sycm.taobao.com/mc/ci/(shop|item|brand)/trend.json",data:[]},currentDate:{urlReg:"https://sycm.taobao.com/ipoll/activity/getCurrentTime.json"}},r="http://www.chaquanzhong.com",i="1.0.6"},function(e,t,a){"use strict";a.d(t,"a",function(){return u});var n=a(1),r=a(0),i=0,o={payRate:[],tradeIndex:[],payByr:[],uvIndex:[],seIpv:[],cartHit:[],cltHit:[]};function s(e,t,a,s,c,d,l){var p="payRate"==t||"payRateIndex"==t?1:"tradeIndex"==t?2:"payByr"==t||"payByrCntIndex"==t?3:"uvIndex"==t?4:"seIpv"==t||"seIpvUvHits"==t?5:"cartHit"==t||"cartHits"==t?6:"cltHit"==t||"cltHits"==t?7:"",u=localStorage.getItem("chaqz_token");chrome.runtime.sendMessage({key:"getData",options:{url:n.a+"/api/v1/plugin/flowFormula?type="+p,type:"POST",contentType:"application/json,charset=utf-8",headers:{Authorization:"Bearer "+u},data:JSON.stringify({exponent:e})}},function(e){if(i++,200==e.code?l?o[l][t]=e.data:o[t]=e.data:2030==e.code&&(LogOut(),i=0),i>s-1){var n="monitShop"==c?function(e){for(var t=[],a=o.payRate.length,n=0;n<a;n++){var i={shop:{}},s=e[n].cate_cateRankId;i.shop={title:e[n].shop.title,url:e[n].shop.pictureUrl},i.cate_cateRankId=s&&s.value?s.value:"-",i.tradeIndex=Math.round(o.tradeIndex[n]),i.uvIndex=Math.round(o.uvIndex[n]),i.seIpv=Math.round(o.seIpv[n]),i.cltHit=Math.round(o.cltHit[n]),i.cartHit=Math.round(o.cartHit[n]),i.payRate=o.payRate[n].toFixed(2)+"%",i.payByr=Object(r.m)(o.payByr[n],"inter"),i.kdPrice=Object(r.f)(o.tradeIndex[n],o.payByr[n],1),i.uvPrice=Object(r.f)(o.tradeIndex[n],o.uvIndex[n],1),i.searRate=Object(r.f)(o.seIpv[n],o.uvIndex[n],2),i.scRate=Object(r.f)(o.cltHit[n],o.uvIndex[n],2),i.jgRate=Object(r.f)(o.cartHit[n],o.uvIndex[n],2),t.push(i)}return t}(d):"monitFood"==c?function(e){for(var t=[],a=o.payRate.length,n=0;n<a;n++){var i,s=Object(r.m)(o.payRate[n],"precent"),c=Object(r.m)(o.uvIndex[n]);i="-"==s||"-"==c?"-":Math.round(s*c/100);var d={shop:{}},l=e[n].cateRankId;d.shop={title:e[n].item.title,url:e[n].item.pictUrl},d.cate_cateRankId=l?l.value:"-",d.tradeIndex=Math.round(o.tradeIndex[n]),d.uvIndex=Math.round(o.uvIndex[n]),d.seIpv=Math.round(o.seIpv[n]),d.cltHit=Math.round(o.cltHit[n]),d.cartHit=Math.round(o.cartHit[n]),d.payRate=o.payRate[n].toFixed(2)+"%",d.payByr=i,d.kdPrice=Object(r.f)(o.tradeIndex[n],i,1),d.uvPrice=Object(r.f)(o.tradeIndex[n],o.uvIndex[n],1),d.searRate=Object(r.f)(o.seIpv[n],o.uvIndex[n],2),d.scRate=Object(r.f)(o.cltHit[n],o.uvIndex[n],2),d.jgRate=Object(r.f)(o.cartHit[n],o.uvIndex[n],2),t.push(d)}return t}(d):"monitCompareFood"==c?o:"monitResource"==c?{value:o,final:d}:"marketShop"==c?{value:o,final:d}:"marketHotShop"==c?{value:o,final:d}:{value:o};i=0,a(n)}})}function c(e,t){if(e){var a=$(".oui-date-picker .ant-btn-primary").text(),n=JSON.parse(e);return"实 时"!=a?n:n.data.data?n.data.data:n.data}return""}function d(e,t){if(e){if("page"==t){var a=$(".oui-date-picker .ant-btn-primary").text(),n=JSON.parse(e);return"实 时"!=a?n:n.data.data.data?n.data.data:n.data}return a=$(".oui-date-picker .ant-btn-primary").text(),n=JSON.parse(e),"实 时"!=a?n:n.data.data.data?n.data.data.data:n.data.data}return""}function l(e){e&&e.forEach(e=>{var t=e.payRateIndex?e.payRateIndex.value:0,a=e.tradeIndex?e.tradeIndex.value:0,n=e.payByrCntIndex?e.payByrCntIndex.value:0,r=e.uvIndex?e.uvIndex.value:0,i=e.seIpvUvHits?e.seIpvUvHits.value:0,s=e.cartHits?e.cartHits.value:0,c=e.cltHits?e.cltHits.value:0;o.payRate.push(t),o.tradeIndex.push(a),o.payByr.push(n),o.uvIndex.push(r),o.seIpv.push(i),o.cartHit.push(s),o.cltHit.push(c)})}function p(e){var t={tradeIndex:[]};if(e)return e.forEach(e=>{t.tradeIndex.push(e.tradeIndex.value)}),t}function u(e,t,a){if(o={payRate:[],tradeIndex:[],payByr:[],uvIndex:[],seIpv:[],cartHit:[],cltHit:[]},"version"==e.type)getVersion(e.ver,t);else if("monitShop"==e.type){var n=c(a[e.type].data);for(var r in n&&n.forEach(e=>{var t=e.shop_payRateIndex?e.shop_payRateIndex.value:0,a=e.shop_tradeIndex?e.shop_tradeIndex.value:0,n=e.shop_payByrCntIndex?e.shop_payByrCntIndex.value:0,r=e.shop_uvIndex?e.shop_uvIndex.value:0,i=e.shop_seIpvUvHits?e.shop_seIpvUvHits.value:0,s=e.shop_cartHits?e.shop_cartHits.value:0,c=e.shop_cltHits?e.shop_cltHits.value:0;o.payRate.push(t),o.tradeIndex.push(a),o.payByr.push(n),o.uvIndex.push(r),o.seIpv.push(i),o.cartHit.push(s),o.cltHit.push(c)}),o)s(o[r],r,t,Object.keys(o).length,"monitShop",n)}else if("monitFood"==e.type){var i=(y=d(localStorage.getItem(e.dataType),"page")).data.data?y.data.data:y.data,u=y.recordCount?y:y.data;for(var r in l(i),o)s(o[r],r,t,Object.keys(o).length,"marketShop",u)}else if("monitCompareFood"==e.type){var m=c(localStorage.getItem(e.dataType));for(var r in function(e){e&&[e.selfItem,e.rivalItem1,e.rivalItem2].filter(function(e){return e}).forEach(function(e){var t=e.payRateIndex?e.payRateIndex.value:0,a=e.tradeIndex?e.tradeIndex.value:0,n=e.uvIndex?e.uvIndex.value:0,r=e.seIpvUvHits?e.seIpvUvHits.value:0,i=e.cartHits?e.cartHits.value:0,s=e.cltHits?e.cltHits.value:0;o.payRate.push(t),o.tradeIndex.push(a),o.uvIndex.push(n),o.seIpv.push(r),o.cartHit.push(i),o.cltHit.push(s)})}(m),o)s(o[r],r,t,Object.keys(o).length,"monitCompareFood",m)}else if("monitResource"==e.type){var v=c(localStorage.getItem(e.dataType)),h=function(e,t){var a={selfItem:{payRate:[],tradeIndex:[],payByr:[],uvIndex:[]}};return t.rivalItem1Id&&(a.rivalItem1={payRate:[],tradeIndex:[],payByr:[],uvIndex:[]}),t.rivalItem2Id&&(a.rivalItem2={payRate:[],tradeIndex:[],payByr:[],uvIndex:[]}),e&&e.forEach(function(e){var n=a.selfItem,r=e.selfItemPayRateIndex?e.selfItemPayRateIndex.value:0,i=e.selfItemTradeIndex?e.selfItemTradeIndex.value:0,o=e.selfItemPayByrCntIndex?e.selfItemPayByrCntIndex.value:0,s=e.selfItemUv?e.selfItemUv.value:0;if(n.payRate.push(r),n.tradeIndex.push(i),n.payByr.push(o),n.uvIndex.push(s),t.rivalItem1Id){var c=a.rivalItem1,d=e.rivalItem1PayRateIndex?e.rivalItem1PayRateIndex.value:0,l=e.rivalItem1TradeIndex?e.rivalItem1TradeIndex.value:0,p=e.rivalItem1PayByrCntIndex?e.rivalItem1PayByrCntIndex.value:0,u=e.rivalItem1Uv?e.rivalItem1Uv.value:0;c.payRate.push(d),c.tradeIndex.push(l),c.payByr.push(p),c.uvIndex.push(u)}if(t.rivalItem2Id){var m=a.rivalItem2,v=e.rivalItem2PayRateIndex?e.rivalItem2PayRateIndex.value:0,h=e.rivalItem2TradeIndex?e.rivalItem2TradeIndex.value:0,f=e.rivalItem2PayByrCntIndex?e.rivalItem2PayByrCntIndex.value:0,g=e.rivalItem2Uv?e.rivalItem2Uv.value:0;m.payRate.push(v),m.tradeIndex.push(h),m.payByr.push(f),m.uvIndex.push(g)}}),a}(v,a.monitResource.ids),f=2==Object.keys(h).length?6:9;for(var r in o.selfItem={},o.rivalItem1={},o.rivalItem2={},h)for(var g in h[r])"uvIndex"!=g?s(h[r][g],g,t,f,"monitResource",v,r):o[r][g]=h[r][g]}else if("marketShop"==e.type||"marketFood"==e.type)for(var r in i=(e.type,y=d(localStorage.getItem(e.dataType),"page")).data.data?y.data.data:y.data,u=y.recordCount?y:y.data,l(i),o)s(o[r],r,t,Object.keys(o).length,"marketShop",u);else if("marketHotShop"==e.type||"marketHotFood"==e.type){var I=p((y=d(localStorage.getItem(e.dataType),"page")).data);for(var r in I)s(I[r],r,t,Object.keys(I).length,"marketHotShop",y)}else if("marketHotShop"==e.type||"marketHotFood"==e.type){var y;for(var r in I=p((y=d(localStorage.getItem(e.dataType),"page")).data))s(I[r],r,t,Object.keys(I).length,"marketHotShop",y)}else if("hotsale"==e.type){var b=function(e){var t={tradeIndex:[],payRate:[]};return e.length?(e.forEach(function(e){t.tradeIndex.push(e.tradeIndex.value),t.payRate.push(e.payRateIndex.value)}),t):[]}(e.dataType);for(var r in b)s(b[r],r,t,Object.keys(b).length,"hotsale")}else if("hotsearch"==e.type){var x=function(e){var t={seIpv:[],uvIndex:[],tradeIndex:[]};return e.length?(e.forEach(function(e){t.tradeIndex.push(e.tradeIndex.value),t.seIpv.push(e.seIpvUvHits.value),t.uvIndex.push(e.uvIndex.value)}),t):[]}(e.dataType);for(var r in x)s(x[r],r,t,Object.keys(x).length,"hotsearch")}else if("hotpurpose"==e.type){var S=function(e){var t={cartHit:[],cltHit:[],tradeIndex:[]};return e.length?(e.forEach(function(e){t.tradeIndex.push(e.tradeIndex.value),t.cartHit.push(e.cartHits.value),t.cltHit.push(e.cltHits.value)}),t):[]}(e.dataType);for(var r in S)s(S[r],r,t,Object.keys(S).length,"hotpurpose")}else if("dealTrend"==e.type){var w=e.dataType;for(var r in w)s(w[r],r,t,Object.keys(w).length,"dealTrend")}else if("singleCompete"==e.type){var k=function(e){if(!e)return"";var t={payRate:[],tradeIndex:[],payByr:[]};return e.forEach(function(e){var a=e.rivalItem1PayRateIndex?e.rivalItem1PayRateIndex.value:0,n=e.rivalItem1TradeIndex?e.rivalItem1TradeIndex.value:0,r=e.rivalItem1PayByrCntIndex?e.rivalItem1PayByrCntIndex.value:0;t.payRate.push(a),t.tradeIndex.push(n),t.payByr.push(r)}),t}(e.dataType);for(var r in k)s(k[r],r,t,Object.keys(k).length,"singleCompete")}return!0}},,function(e,t,a){"use strict";a.r(t);var n=a(1),r=a(0),i=a(2),o=!1,s={},c={};window.dataWrapper2=n.c,window.SAVE_MEMBER2=s,window.SAVE_BIND2=c,localStorage.getItem("isFirstInstallPlugin")||(localStorage.clear(),localStorage.setItem("isFirstInstallPlugin","hasInstall")),chrome.runtime.sendMessage({type:"hello",fitlerArr:n.c},function(e){}),chrome.storage.local.get("chaqz_token",function(e){var t=e.chaqz_token;t?(localStorage.setItem("chaqz_token",t),o=!0):o=!1}),$(function(){$(document).on("click","#loginbtn",function(){return d.init(),!1}),$(document).on("click","#userBtn",function(){return d.getInfo(),!1}),function(){if(function(){if(-1!=window.location.href.indexOf("https://sycm.taobao.com/custom/login.htm"))return $(".chaqz-compete-wrap").remove(),!1;o?$("body").append('<div class="chaqz-compete-wrap"><div class="head"><img src="https://file.cdn.chaquanzhong.com/plugin-compete-logo.png" alt=""></div><div class="content" id="parsing"><img src="https://file.cdn.chaquanzhong.com/plugin-compete-analy.png" alt=""></div><div class="footer" id="weightParsing"><img src="https://file.cdn.chaquanzhong.com/weightPars.png" alt=""></div></div>'):$(".chaqz-compete-wrap").remove()}(),!o)return!1;var e=localStorage.getItem("chaqz_token");d.getShopBind(),chrome.runtime.sendMessage({key:"getData",options:{url:n.a+"/api/v1/user/userinfo",type:"GET",headers:{Authorization:"Bearer "+e}}},function(e){if(200==e.code){var t=e.data;t.username=t.account,t.member.expireAt=t.member.expire_at,s=t,window.SAVE_MEMBER2=t}else p()})}(),$("#app").on("DOMNodeInserted",function(e){if("oui-index-picker"==e.target.className&&$(".mc-shopMonitor .oui-card-header-wrapper .oui-card-header").append(l()),"oui-index-picker-group"==e.target.className&&$(".mc-ItemMonitor .oui-card-header-wrapper .oui-card-header").append(l()),"itemAnalysisTrend"==e.target.id&&$(".op-mc-item-analysis #itemAnalysisTrend .oui-card-header").append(l()),"sycm-mc-flow-analysis"==e.target.id&&$(".sycm-mc-flow-analysis .oui-card-header").append(l()),"mc-marketMonitor"==e.target.className&&$(".mc-marketMonitor .oui-card-header-wrapper .oui-card-header").append(l()),"tree-menu common-menu tree-scroll-menu-level-2"==e.target.className&&$(".op-mc-market-monitor-industryCard .oui-card-header-item-pull-right").prepend(l()),"industry-tab-index"==e.target.className&&$(".op-mc-market-rank-container  .oui-card-header-wrapper .oui-card-header").append(l()),"oui-index-picker-group"==e.target.className){if($(".op-mc-market-rank-container .oui-card-header .chaqz-btns").length>0)return!1;$(".op-mc-market-rank-container .oui-card-header").append(l())}}),$(document).on("click","#parsing",function(){r.q.init("competingGoodsAnalysis")}),$(document).on("click","#weightParsing",function(){r.q.init("competingTopAnalysis")})});var d={loginDom:'<div class="chaqz-info-wrapper login"><div class="c-cont"><span class="close2 hided" click="hideInfo">×</span><div class="formList"><div class="title"><img src="https://file.cdn.chaquanzhong.com/logo-info.png" alt="logo"></div><div class="phone"><input id="phone" type="text" placeholder="请输入手机号码"><p class="tips">请输入手机号码</p></div><div class="pwd"><input id="pwd" type="password" placeholder="请输入登录密码"><p class="tips">请输入登录密码</p></div><div class="router"><a href="'+n.a+'/reg" class="right" target="_blank">免费注册</a><a href="'+n.a+'/findP" target="_blank">忘记密码</a></div><button class="orange-default-btn login-btn">登录</button></div></div></div>',infoDom:function(e,t){var a=e.username,i=e.member.title,o=e.member.expireAt,s="",c="未绑定",d=Object(r.d)();i&&o?(s=new Date(o)-1e3*e.time>0?"续费":"订购",t.data.forEach(function(e){(e.mainUid=d.mainUserId)&&(c="已绑定")})):(i="普通会员",o="--",s="订购",c="未绑定");var l='<div class="chaqz-info-wrapper user"><div class="c-cont"><span class="close2 hided">×</span><div class="help"><img src="https://file.cdn.chaquanzhong.com/wenhao.png" alt="?"><a href="'+n.a+'/pluginIntro" target="_blank">帮助</a></div><div class="infoList"><div class="title"><img src="https://file.cdn.chaquanzhong.com/logo-info.png" alt="logo"></div><ul class="user-list"><li><span class="name">账&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;户:</span><span>'+a+'</span><span class="fr" id="logout">退出登录</span></li><li><span class="name">会员信息:</span><span>'+i+'</span></li><li><span class="name">到期时间:</span><span>'+o+'</span><a href="'+n.a+'/homePage?from=plugin" target="_blank" class="fr">'+s+'</a></li><li><span class="name">版&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本:</span><span>'+n.b+'</span></li><li><span class="name">联系客服:</span><span><a href="tencent://message/?uin=3531553166&amp;Site=qq&amp;Menu=yes"><img class="mr_10" src="https://file.cdn.chaquanzhong.com/qq_icon.png" alt="qq"></a><img src="https://file.cdn.chaquanzhong.com/wx_icon.png" alt="wx" class="wxpop"></span></li><li><span class="name">店铺绑定</span><span>'+c+"</span></li></ul></div></div></div>";$("#app").append(l)},login:function(){var e=!1,t=this,a=$(".chaqz-info-wrapper #phone").val(),r=$(".chaqz-info-wrapper #pwd").val();if(!a||!r||e)return!1;chrome.runtime.sendMessage({key:"getData",options:{url:n.a+"/api/v1/user/login",type:"POST",data:JSON.stringify({phone:a,password:r}),contentType:"application/json,charset=utf-8"}},function(a){if(200==a.code){$(".chaqz-info-wrapper").remove();var n=a.data,r=a.data.token;localStorage.setItem("chaqz_token",r),s=n,window.SAVE_MEMBER2=n,chrome.storage.local.set({chaqz_token:r},function(){}),o=!0,t.getShopBind(),u(),$(".chaqz-info-wrapper.login").remove()}else $(".chaqz-info-wrapper.login .pwd .tips").text("账号或密码错误").show(),e=!1})},init:function(){var e=this;$("#app").append(this.loginDom),$(document).on("blur",".chaqz-info-wrapper #phone",function(){var e=$(this).val();e?/^1[34578]\d{9}$/.test(e)?$(this).siblings(".tips").hide():$(this).siblings(".tips").text("请输入正确号码").show():$(this).siblings(".tips").text("请输入手机号码").show()}),$(document).on("blur",".chaqz-info-wrapper #pwd",function(){$(this).val()?$(this).siblings(".tips").hide():$(this).siblings(".tips").text("请输入密码").show()}),$(document).on("click",".chaqz-info-wrapper .login-btn",function(){e.login()}),$(".chaqz-info-wrapper #pwd").bind("keydown",function(t){13==(window.event||t).keyCode&&e.login()}),$(document).on("click",".chaqz-info-wrapper .hided",function(){$(".chaqz-info-wrapper.login").remove()})},getShopBind:function(){var e=localStorage.getItem("chaqz_token");chrome.runtime.sendMessage({key:"getData",options:{url:n.a+"/api/v1/plugin/shop",type:"GET",headers:{Authorization:"Bearer "+e}}},function(e){if(200==e.code){var t=e.data;c=t,window.SAVE_BIND2=t}else 2030==e.code&&p()})},getInfo:function(){var e=$(".chaqz-info-wrapper.user");if(e.length)e.show();else{var t=s,a=c;t.token?this.infoDom(t,a):r.q.init("noShopInfo"),$(document).on("click",".chaqz-info-wrapper .hided",function(){$(".chaqz-info-wrapper.user").hide()}),$(document).on("click","#logout",function(){$(".chaqz-info-wrapper.user").hide(),u("out"),chrome.storage.local.clear(function(){}),localStorage.removeItem("chaqz_token")}),$(document).on("click",".chaqz-info-wrapper.user .wxpop",function(){$(".chaqz-info-wrapper.user").hide(),r.q.init("weixin")})}}};function l(){return o?'<div class="chaqz-btns btnsItem1"><button id="userBtn" class="serachBtn user">用户信息</button><button id="search" class="serachBtn">一键转化</button><button id="vesting" class="serachBtn vesting">一键加权</button><div>':'<div class="chaqz-btns btnsItem1"><button id="loginbtn" class="serachBtn user">登录</button><div>'}function p(){o=!1,u("out"),chrome.storage.local.clear(function(){}),localStorage.removeItem("chaqz_token"),$(".chaqz-compete-wrap").remove(),Object(r.b)()}function u(e){"out"==e?($(".chaqz-btns").html('<button id="loginbtn" class="serachBtn user">登录</button>'),$(".chaqz-compete-wrap").remove()):($(".chaqz-btns").html('<button id="userBtn" class="serachBtn user">用户信息</button><button id="search" class="serachBtn">一键转化</button><button id="vesting" class="serachBtn vesting">一键加权</button>'),$("body").append('<div class="chaqz-compete-wrap"><div class="head"><img src="https://file.cdn.chaquanzhong.com/plugin-compete-logo.png" alt=""></div><div class="content" id="parsing"><img src="https://file.cdn.chaquanzhong.com/plugin-compete-analy.png" alt=""></div><div class="footer" id="weightParsing"><img src="https://file.cdn.chaquanzhong.com/weightPars.png" alt=""></div></div>'))}function m(e){if(!e)return"";for(var t=JSON.parse(e),a=t.length,n=0;n<a;n++)for(var r=0;r<a-1-n;r++)if(t[r].cateRankId.value>t[r+1].cateRankId.value){var i=t[r];t[r]=t[r+1],t[r+1]=i}return JSON.stringify(t)}function v(e){var t=CryptoJS.enc.Utf8.parse("sycmsycmsycmsycm"),a=CryptoJS.enc.Utf8.parse("mcysmcysmcysmcys");let n=CryptoJS.enc.Hex.parse(e),r=CryptoJS.enc.Base64.stringify(n);return CryptoJS.AES.decrypt(r,t,{iv:a,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).toString(CryptoJS.enc.Utf8).toString()}function h(e){var t="";return e.match("item")?t="item":e.match("shop")?t="shop":e.match("brand")&&(t="brand"),t}function f(e){var t={};return e&&e.split("?")[1].split("&").forEach(function(e){var a=e.split("=");"selfItemId"==a[0]&&a[1]?t.selfItemId=a[1]:"rivalItem1Id"==a[0]&&a[1]?t.rivalItem1Id=a[1]:"rivalItem2Id"==a[0]&&a[1]&&(t.rivalItem2Id=a[1])}),t}function g(e,t,a){var n={},r="";if(!e)return"";if(e.split("?")[1].split("&").forEach(function(e){var t=e.split("=");n[t[0]]=t[1]}),localStorage.setItem("shopCateId",n.cateId),n.dateRange=n.dateRange?decodeURIComponent(n.dateRange):"","com"==t){var i=n.rivalItem1Id?"&rivalItem1Id="+n.rivalItem1Id:"",o=n.rivalItem2Id?"&rivalItem2Id="+n.rivalItem2Id:"",s=n.selfItemId?"&selfItemId="+n.selfItemId:"";r+="cateId="+n.cateId+"&dateRange="+n.dateRange+"&dateType="+n.dateType+"&device="+n.device+i+o+s}else if("only"==t)r+="cateId="+n.cateId+"&dateRange="+n.dateRange+"&dateType="+n.dateType+"&device="+n.device+"&itemId="+n.itemId;else if("trendShopInfo"==t){var c="item"==a?"itemId":"shop"==a?"userId":"brandId";r+="cateId="+n.firstCateId+"&userId="+n[c]}else"trend"==t?(c="item"==a?"itemId":"shop"==a?"userId":"brandId",r+="cateId="+n.cateId+"&dateRange="+n.dateRange+"&dateType="+n.dateType+"&device="+n.device+"&sellerType="+n.sellerType+"&userId="+n[c]):r+="cateId="+n.cateId+"&dateRange="+n.dateRange+"&dateType="+n.dateType+"&device="+n.device+"&page="+n.page+"&pageSize="+n.pageSize+"&sellerType="+n.sellerType;return r}$(document).on("click",".chaqz-info-wrapper.pop #goBind",function(){var e=Object(r.d)(),t=localStorage.getItem("chaqz_token");chrome.runtime.sendMessage({key:"getData",options:{url:n.a+"/api/v1/plugin/shop",type:"POST",headers:{Authorization:"Bearer "+t},contentType:"application/json,charset=utf-8",data:JSON.stringify({login_user_id:e.loginUserId,login_user_name:e.loginUserName,main_user_id:e.mainUserId,main_user_name:e.mainUserName,run_as_shop_id:e.runAsShopId,run_as_shop_title:e.runAsShopTitle,run_as_user_id:e.runAsUserId,run_as_shop_type:e.runAsShopType,run_as_user_name:e.runAsUserName})}},function(e){$(".chaqz-info-wrapper.pop").hide(),200==e.code?(Object(r.p)("已绑定成功"),window.location.reload()):4005==e.code?Object(r.p)("用户无绑定店铺权限"):4006==e.code?Object(r.p)("超出绑定上限"):5005==e.code?Object(r.p)("店铺已被其他账号绑定 "):2030==e.code?p():Object(r.p)("绑定失败")}),$(".chaqz-info-wrapper.pop").hide()}),$(document).on("change",".chaqz-info-wrapper.pop .table-wrap input",function(){$(".chaqz-info-wrapper.pop input:checked").length>c.count?($(this).prop({checked:!1}),Object(r.p)("绑定用户达上限","top:10%;")):$(this).prop("checked")?$(this).siblings("label").addClass("chose"):$(this).siblings("label").removeClass("chose")}),$(document).on("click",".chaqz-info-wrapper.pop .activeShop",function(){var e=$(".chaqz-info-wrapper.pop input:checked:not(:disabled)"),t=e.length,a=localStorage.getItem("chaqz_token");if(t)for(var i=0,o=(a=localStorage.getItem("chaqz_token"),0);o<t;o++){var s=$(e[o]).data("id");chrome.runtime.sendMessage({key:"getData",options:{url:n.a+"/api/v1/plugin/shop",type:"PATCH",headers:{Authorization:"Bearer "+a},contentType:"application/json,charset=utf-8",data:JSON.stringify({run_as_shop_id:s})}},function(e){200==e.code?Object(r.p)("激活成功","top:10%;"):Object(r.p)("激活失败","top:10%;"),++i>t-1&&window.location.reload()})}}),$(document).on("click",".chaqz-info-wrapper.pop .analyBtn2",function(){Object(r.b)("show");var e=$(".chaqz-info-wrapper.pop .anayEditor").val(),t=$(".chaqz-info-wrapper.pop .good-tips");if(!e)return t.text("请输入url或者id"),t.addClass("alert"),Object(r.b)(),!1;var a=Object(r.s)(e);if(!a)return t.text("请输入正确url或者id"),$(".chaqz-info-wrapper.pop .good-tips").addClass("alert"),Object(r.b)(),!1;var o=localStorage.getItem("chaqz_token");chrome.runtime.sendMessage({key:"getData",options:{url:n.a+"/py/api/v1/item?id="+a,type:"GET",headers:{Authorization:"Bearer "+o}}},function(e){if(200==e.code){if(Object(r.i)()!=e.data.rootCategoryId)return t.html('校验失败,仅支持同类目商品！<a class="contactService">请联系客服</a>'),$(".chaqz-info-wrapper.pop .good-tips").addClass("alert"),Object(r.b)(),!1;var o={pic:e.data.images[0],title:e.data.title,priceRange:"￥"+e.data.min_price+"~￥"+e.data.max_price};console.log(e.data.categoryId),function(e,t,a){var o=Object(r.g)("moreDay"),s=Object(r.r)(o,"recent7"),c=(localStorage.getItem("shopCateId"),"https://sycm.taobao.com/mc/mq/mkt/rank/item/hotsale.json?dateRange="+s+"&dateType=recent7&pageSize=100&page=2&order=desc&orderBy=tradeIndex&cateId="+t+"&device=0&sellerType=-1&indexCode=cateRankId%2CtradeIndex%2CtradeGrowthRange%2CpayRateIndex");chrome.storage.local.get("transitId",function(o){$.ajax({url:c,type:"GET",headers:{"transit-id":o.transitId},error:function(){Object(r.p)("获取数据失败请重试！"),Object(r.b)()},success:function(s){if(0===s.code){var c=function(e){var t="";if(!e.length)return"";for(var a=e.length,n=0;n<a;n++)if(1==e[n].cateRankId.value){t=e[n];break}return t}(JSON.parse(v(s.data)));console.log(c),function(e){var t=Object(r.g)("moreDay"),a=Object(r.r)(t,"recent7"),o=(localStorage.getItem("shopCateId"),"https://sycm.taobao.com/mc/rivalItem/analysis/getCoreIndexes.json?dateType=recent7&dateRange="+a+"&device=0&cateId="+e.category+"&rivalItem1Id="+e.rivald);$.ajax({url:o,type:"GET",headers:{"transit-id":e.transId},error:function(){Object(r.p)("获取数据失败请重试！"),Object(r.b)()},success:function(t){if(0!==t.code||!t.data)return Object(r.p)("获取数据失败请重试！"),Object(r.b)(),!1;var s=JSON.parse(v(t.data)).rivalItem1,c="https://sycm.taobao.com/mc/rivalItem/analysis/getCoreIndexes.json?dateType=recent7&dateRange="+a+"&device=0&cateId="+e.category+"&rivalItem1Id="+e.rivald2;$.ajax({url:c,type:"GET",headers:{"transit-id":e.transId},error:function(){Object(r.p)("获取数据失败请重试！"),Object(r.b)()},success:function(t){if(0!==t.code||!t.data)return Object(r.p)("获取数据失败请重试！"),Object(r.b)(),!1;var a=JSON.parse(v(t.data)).rivalItem1,d=function(e,t){var a={cartHits:[],cltHits:[],payRateIndex:[],seIpvUvHits:[],tradeIndex:[],uvIndex:[]};for(var n in a)a[n].push(e[n].value),a[n].push(t[n].value);return a}(s,a);console.log(o,s),console.log(c,a),Object(i.a)({type:"dealTrend",dataType:d},function(t){var i=t.value;i.payItemCnt=[],i.payItemCnt.push(s.payItemCnt.value),i.payItemCnt.push(a.payItemCnt.value),function(e,t){var a={},i={};a.payItemCnt=e.payItemCnt[0],a.cartHits=e.cartHits[0],a.cltHits=e.cltHits[0],a.seIpvUvHits=e.seIpvUvHits[0],a.tradeIndex=e.tradeIndex[0],a.uvIndex=e.uvIndex[0],i.payItemCnt=e.payItemCnt[1],i.cartHits=e.cartHits[1],i.cltHits=e.cltHits[1],i.seIpvUvHits=e.seIpvUvHits[1],i.tradeIndex=e.tradeIndex[1],i.uvIndex=e.uvIndex[1];var o=localStorage.getItem("chaqz_token");chrome.runtime.sendMessage({key:"getData",options:{url:n.a+"/py/api/v1/weight",type:"POST",headers:{Authorization:"Bearer "+o},data:JSON.stringify({selfItem:a,item:i}),contentType:"application/json,charset=utf-8"}},function(e){200==e.code?function(e,t){var a='<div class="chaqz-wrapper weight-pop"><div class="content"><div class="cha-box"><div class="parsing-title">竞品权重解析</div><div class="weight-parsing"><div class="left"><div class="head-info"><img src="'+e.pic+'" alt="pic"><div class="name"><p>'+e.title+'</p><span class="price">'+e.priceRange+'</span></div></div><div id="chaqzx-echarts-wrap"></div></div><div class="right"><div class="scores"><p class="sorce-head">本次权重得分</p><p class="dScore"></p><p class="moreShop">超过市场'+t.rank+'%商品</p></div><div class="proposal"><div class="propos-title">优化方案</div><ul class="prompt-list"><li><span>标题热度提升</span><button>优化</button></li><li><span>补冲流量，稳定转化</span><button>优化</button></li><li><span>补充单量</span><button>优化</button></li></ul></div></div></div></div><span class="chaqz-close">×</span></div></div>';$("#app").append(a),$(document).on("click",".weight-pop button",function(){Object(r.p)("开发中,敬请期待")}),$(".weight-pop .dScore").animate({num:"dd"},{duration:1e3,easing:"swing",step:function(e,a){$(this).html(parseInt(a.pos*t.combat))}});var n=t.weight,i=echarts.init(document.getElementById("chaqzx-echarts-wrap")),o={grid:{top:"10%"},tooltip:{},radar:{name:{textStyle:{color:"#888",fontSize:14}},splitNumber:4,indicator:[{name:"流量",max:n.uvIndex.max_index},{name:"客群",max:n.payItemCnt.max_index},{name:"坑产",max:n.tradeIndex.max_index},{name:"收藏",max:n.cltHits.max_index},{name:"加购",max:n.cartHits.max_index},{name:"搜索",max:n.seIpvUvHits.max_index}]},series:[{name:"商品权重",type:"radar",areaStyle:{color:"rgba(235,111,60,0.38)"},itemStyle:{borderWidth:2,borderColor:"#EB6F3C"},lineStyle:{color:"#EB6F3C",width:2},data:[{value:[n.uvIndex.log,n.payItemCnt.log,n.tradeIndex.log,n.cltHits.log,n.cartHits.log,n.seIpvUvHits.log]}]}]};i.setOption(o),Object(r.b)()}(t,e.data):2030==e.code?p():Object(r.p)("解析失败"),$(".chaqz-info-wrapper.pop").hide(),Object(r.b)()})}(i,e.itemInfo)})}})}})}({rivald:e,rivald2:c.itemId.value,transId:o.transitId,itemInfo:a,category:t})}else Object(r.p)("转化失败,请重试！"),Object(r.b)()}})})}(a,e.data.categoryId,o)}else 2030==e.code?(p(),Object(r.b)()):(t.html('校验失败！<a class="contactService">请联系客服</a>'),$(".chaqz-info-wrapper.pop .good-tips").addClass("alert"),Object(r.b)())})}),chrome.runtime.onMessage.addListener(function(e,t,a){if("holdup"==e.type){var r=e.url,i=e.back;if(r)for(var o in n.c)if(new RegExp(n.c[o].urlReg).test(r)){var s=JSON.parse(i).data?JSON.parse(i).data:"",c="object"==typeof s?i:v(s);if("monitShop"==o||"getMonitoredList"==o)n.c[o].data=c,window.dataWrapper2[o].data=c;else if("shopInfo"==o)n.c[o].data=c,window.dataWrapper2[o].data=c,localStorage.setItem("chaqz_"+o,c);else if("compareSelfList"==o)localStorage.setItem("chaqz_"+o,c);else if("monitCompareFood"==o){var d=g(r,"com");localStorage.setItem(o+d,c)}else if("getKeywords"==o)-1!=r.indexOf("topType=trade")&&(d=g(r,"only"),localStorage.setItem(o+d,c));else if("monitResource"==o)d=g(r,"com"),localStorage.setItem(o+d,c),n.c[o].ids=f(r),window.dataWrapper2[o].ids=f(r);else if("hotsale"==o||"hotsearch"==o||"hotpurpose"==o){d=g(r);var l=h(r),p=m(c);localStorage.setItem(l+"/"+o+d,p)}else"allTrend"==o?(d=g(r,"trend",l=h(r)),localStorage.setItem(l+"/"+o+d,c)):"trendShop"==o?(d=g(r,"trendShopInfo",l=h(r)),localStorage.setItem(l+"/"+o+d,c)):"currentDate"==o?localStorage.setItem(o,c):(d=g(r),localStorage.setItem(o+d,c))}a("shoudao")}}),chrome.runtime.sendMessage({type:"listenContat"},function(){}),chrome.runtime.onMessage.addListener(function(e,t,a){return"secahKeywords"==e.type&&function(e,t){$(".oui-date-picker .oui-canary-btn:contains('7天')").click(),chrome.storage.local.get("transitId",function(a){var n=$(".ebase-FaCommonFilter__root .oui-date-picker .oui-date-picker-current-date").text().split(" "),r=n.length,i="";3==r||2==r?i=n[1]+"|"+n[1]:4==r&&(i=n[1]+"|"+n[3]);var o="https://sycm.taobao.com/mc/searchword/relatedWord.json?dateRange="+encodeURIComponent(i)+"&dateType=recent7&pageSize=10&page=1&order=desc&orderBy=tradeIndex&keyword="+encodeURIComponent(e)+"&device=0",s=localStorage.getItem("chaqz_search_keywords?"+i+"&keywords="+e);if(s)return t(v(s)),!1;$.ajax({url:o,type:"GET",headers:{"transit-id":a.transitId},success:function(a){var n=a.data?v(a.data):"";localStorage.setItem("chaqz_search_keywords?"+i+"&keywords="+e,a.data),t(n)}})})}(e.keywords,a),!0})}]);